import{_ as c,c as l,a as o,o as a,r as w,n as M,i as I,p as L,w as $,d as k,b as i,v as x,q as g,g as C,e as V,l as D}from"./index-7Gs8P-Jn.js";import{s as E,g as U,d as b}from"./db-CyDEoqJs.js";const T={},R={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function j(u,n){return a(),l("svg",R,n[0]||(n[0]=[o("path",{d:"M21 12H3M3 12L10 5M3 12L10 19",stroke:"#ffffff","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const H=c(T,[["render",j]]),F={},O={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function q(u,n){return a(),l("svg",O,n[0]||(n[0]=[o("path",{d:"M12 3V17M12 17L6 11M12 17L18 11M3 21H21",stroke:"#ffffff","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const A=c(F,[["render",q]]),G={},S={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"};function Z(u,n){return a(),l("svg",S,n[0]||(n[0]=[o("path",{d:"M9 3H15M3 6H21M10 16V11M14 16V11M5 6H19L18.1245 19.133C18.0544 20.1836 17.1818 21 16.1289 21L7.8461 21C6.79171 21 5.91842 20.1814 5.85028 19.1292L5 6Z",stroke:"#ffffff","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const z=c(G,[["render",Z]]),J={key:0,class:"note"},K={class:"note-container"},P={class:"note-header"},Q={class:"note-header-right"},W={key:1,class:"hint"},X={__name:"NoteView",emits:["noteDeleted","refreshNotes"],setup(u,{emit:n}){const d=n,p=M(),h=D(),_=w(parseInt(p.params.id)),e=w(null);let f=null;const m=async()=>{const s=await U();e.value=s.find(t=>t.id===_.value)||null};I(()=>{m(),f=setInterval(()=>{e.value&&(e.value.title||e.value.content)&&E(e.value)},200)}),L(()=>{clearInterval(f)}),$(()=>p.params.id,s=>{_.value=parseInt(s),m()});const y=async()=>{if(e.value&&window.confirm("Are you sure you want to delete this record?"))try{clearInterval(f),await b(e.value.id),e.value=null,d("noteDeleted"),d("refreshNotes"),h.replace("/")}catch(t){console.error("Error deleting the note:",t),alert("Failed to delete the note.")}},N=()=>{if(!e.value)return;const s=`${(e.value.title||"Empty").toUpperCase()} | ${e.value.date}

${e.value.content||"Empty"}`,t=new Blob([s],{type:"text/plain; charset=utf-8"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.download="note.txt",r.click(),URL.revokeObjectURL(r.href)},B=async()=>{if(e.value&&!e.value.title&&!e.value.content)try{await b(e.value.id)}catch(s){console.error("Error deleting empty note:",s)}h.replace("/"),d("refreshNotes")};return(s,t)=>{const r=V("router-link");return e.value?(a(),l("div",J,[o("div",K,[o("div",P,[o("button",{onClick:B,class:"button go-back-button",title:"Go Back"},[i(H)]),o("div",Q,[o("button",{class:"button export-button",type:"button",title:"Export",onClick:N},[i(A)]),o("button",{onClick:y,class:"button delete-button",title:"Delete"},[i(z)])])]),k(o("input",{"onUpdate:modelValue":t[0]||(t[0]=v=>e.value.title=v),placeholder:"Title",class:"note-input note-title",ref:"titleTextarea",type:"text",maxlength:"100"},null,512),[[x,e.value.title]]),k(o("textarea",{"onUpdate:modelValue":t[1]||(t[1]=v=>e.value.content=v),placeholder:"Tell a new story...",class:"note-input note-text",ref:"contentTextarea",maxlength:"30000"},null,512),[[x,e.value.content]])])])):(a(),l("div",W,[t[3]||(t[3]=g(" Note not found ")),i(r,{to:"/",class:"button"},{default:C(()=>t[2]||(t[2]=[g("Back to main page")])),_:1})]))}}},te=c(X,[["__scopeId","data-v-0d74a258"]]);export{te as default};
